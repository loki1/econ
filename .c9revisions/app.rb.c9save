{"ts":1353312474541,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"#encoding: utf-8\n\nrequire 'rubygems'\nrequire 'sinatra'\nrequire 'haml'\n\nenable :sessions\n\nget('/') {haml :login}\n\npost \"/login\" do\n\tsession['name'] = params[:name]\n\t\n\tredirect '/index'\nend\n\nget('/index') {haml :index}"]],"start1":0,"start2":0,"length1":0,"length2":216}]],"length":216}
{"contributors":[],"silentsave":false,"ts":1353312469203,"patch":[[{"diffs":[[0,"e 'haml'"],[1,"\nrequire 'sass'"],[0,"\n\nenable"]],"start1":61,"start2":61,"length1":16,"length2":31}]],"length":231,"saved":false}
{"ts":1353312704375,"patch":[[{"diffs":[[0,"[:name]\n"],[-1,"\t"],[0,"\n\tredire"]],"start1":170,"start2":170,"length1":17,"length2":16}]],"length":230,"saved":false}
{"contributors":[],"silentsave":false,"ts":1353506796028,"patch":[[{"diffs":[[0,"e 'haml'"],[1,"\n#require 'sass'"],[0,"\n\nenable"]],"start1":61,"start2":61,"length1":16,"length2":32}]],"length":231,"saved":false}
{"contributors":[],"silentsave":false,"ts":1353507158335,"patch":[[{"diffs":[[0,"ml'\n"],[-1,"#require 'sass'"],[1,"require \"active_record\"\nrequire \"pg\"\n\nconfigure :development do\n  ActiveRecord::Base.establish_connection(\n\t    :adapter => \"postgresql\",\n\t    :database  => \"econ\",\n\t\t\t:username => \"postgres\",\n\t\t\t:password => \"123\"\n\t)\nend\n\nconfigure :production do\n\tActiveRecord::Base.establish_connection(\n\t    :adapter => \"postgresql\",\n\t    :database  => \"econ\",\n\t\t\t:username => \"postgres\"\n\t)\nend\n\nclass Victim < ActiveRecord::Base\nend"],[0,"\n\nen"]],"start1":66,"start2":66,"length1":23,"length2":428},{"diffs":[[0,"\nget"],[-1,"('/') {haml :login}\n\npost \"/login\" do\n"],[1," '/' do\n\tif session['name'].nil?\n\t\thaml :login\n\telse\n\t\tredirect :edit\n\tend\nend\n\nget '/edit' do\n\tif session['name'].nil?\n\t\tredirect '/'\n\telse\n\t\t@victim = Victim.first\n\t\t\n\t\tif @victim.free == true\n\t\t\t@victim.update_attributes :free => false\n\t\t\t\n\t\t\thaml :edit\n\t\telse\n\t\t\thaml :read\n\t\tend\n\tend\nend\n\npost '/edit' do\n\t@victim = Victim.first\n\t@victim.content = \"#{params[:content]}\"\n\t@victim.free = true\n\t@victim.save\n\t\n\tredirect '/edit'\nend\n\npost \"/login\" do\n\tif params[:name] == 'loki' && params[:pass] == 'pass'\n\t"],[0,"\tses"]],"start1":509,"start2":509,"length1":46,"length2":516},{"diffs":[[0,"[:name]\n"],[-1,"\n"],[1,"\t"],[0,"\tredirec"]],"start1":1046,"start2":1046,"length1":17,"length2":17},{"diffs":[[0,"t '/"],[-1,"index'"],[1,"edit'\n\telse\n\t\tredirect '/'\n\tend"],[0,"\nend\n\n"],[-1,"get('/index') {haml :index}"],[1,"set :public_folder, File.dirname(__FILE__) + '/static'\n"]],"start1":1063,"start2":1063,"length1":43,"length2":96}]],"length":1159,"saved":false}
